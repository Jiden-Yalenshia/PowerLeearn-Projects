import os
import requests

# Step 1: Prompt the user for an image URL
image_url = input("Enter the URL of the image: ")

# Step 2: Create directory if it doesn't exist
directory = "Fetched_Images"
if not os.path.exists(directory):
    os.makedirs(directory)

try:
    # Step 3: Download the image
    response = requests.get(image_url, timeout=10)
    response.raise_for_status()  # Raises HTTPError for bad responses (4xx or 5xx)

    # Step 4: Determine a filename from the URL
    filename = os.path.join(directory, image_url.split("/")[-1])
    if not filename.lower().endswith((".png", ".jpg", ".jpeg", ".gif", ".bmp")):
        filename += ".jpg"  # default extension if none found

    # Step 5: Save the image
    with open(filename, "wb") as f:
        f.write(response.content)

    print(f"Image downloaded and saved as '{filename}'")

except requests.exceptions.MissingSchema:
    print("Error: The URL is invalid.")
except requests.exceptions.ConnectionError:
    print("Error: Failed to connect to the URL.")
except requests.exceptions.Timeout:
    print("Error: The request timed out.")
except requests.exceptions.HTTPError as e:
    print(f"HTTP Error: {e}")
except Exception as e:
    print(f"An unexpected error occurred: {e}")
